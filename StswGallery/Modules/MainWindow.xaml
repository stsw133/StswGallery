<se:StswWindow x:Class="StswGallery.MainWindow"
               xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
               xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
               xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
               xmlns:se="clr-namespace:StswExpress;assembly=StswExpress"
               xmlns:local="clr-namespace:StswGallery"
               mc:Ignorable="d" d:DataContext="{d:DesignInstance local:MainContext}"
               Height="450" Width="750" WindowStartupLocation="CenterScreen" WindowState="Maximized"
               Title=""
               Loaded="{se:StswEventToCommand InitCommand}"
               PreviewKeyDown="{se:StswEventToCommand KeyPressCommand, PassEventArgs=True}">
    <se:StswWindow.DataContext>
        <local:MainContext/>
    </se:StswWindow.DataContext>
    <se:StswWindow.Resources>
        <se:StswBindingProxy x:Key="proxy" Proxy="{Binding}"/>
    </se:StswWindow.Resources>

    <se:StswContentDialog CloseOnBackdropClick="True" Identifier="ConfigContentDialog" IsOpen="{Binding IsConfigOpen}" IsTabStop="False">
        <Grid>
            <!-- image -->
            <se:StswZoomControl>
                <Image Source="{Binding ImageSource}" RenderOptions.BitmapScalingMode="Fant"/>
            </se:StswZoomControl>
            <!-- default button -->
            <se:StswSubButton d:Foreground="White"
                              Command="{Binding SelectDirectoryCommand}"
                              Content="Click to select a directory..."
                              Focusable="False"
                              IsTabStop="False"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch"
                              Visibility="{Binding DirectoryPath, Converter={x:Static se:StswExistenceConverter.Instance}, ConverterParameter=null}"/>
            <!-- option panel -->
            <se:StswSidePanel MinHeight="50"
                              MinWidth="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type Grid}}, Converter={x:Static se:StswCalculateConverter.Instance}, ConverterParameter='*0.99'}"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Bottom"
                              HorizontalContentAlignment="Center">
                <se:StswBorder BorderBrush="{DynamicResource StswBorder.Static.Border}" BorderThickness="2 2 2 0">
                    <DockPanel Background="{DynamicResource StswBox.Static.Background}">
                        <!-- top side -->
                        <DockPanel DockPanel.Dock="Top">
                            <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding SelectDirectoryCommand}" Focusable="False">
                                <se:StswIcon Data="{x:Static se:StswIcons.FolderOpen}"/>
                            </se:StswButton>
                            <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding RefreshCommand}" Focusable="False">
                                <se:StswIcon Data="{x:Static se:StswIcons.Refresh}"/>
                            </se:StswButton>
                            <se:StswSeparator Orientation="Vertical"/>

                            <se:StswTextBox se:StswControl.IsBorderless="True" FontSize="10" IsReadOnly="True" Width="500" Text="{Binding DirectoryPath}" VerticalAlignment="Stretch"/>
                        </DockPanel>
                        <se:StswSeparator DockPanel.Dock="Top"/>
                        <!-- bottom side -->
                        <DockPanel DockPanel.Dock="Top">
                            <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding ConfigCommand}" Focusable="False">
                                <se:StswIcon Data="{x:Static se:StswIcons.Cog}"/>
                            </se:StswButton>

                            <se:StswDropButton Focusable="False"
                                               Visibility="Collapsed"
                                               se:StswControl.IsBorderless="True"
                                               se:StswDropArrow.Visibility="Collapsed"
                                               se:StswPopup.Background="Transparent"
                                               se:StswPopup.BorderThickness="0">
                                <se:StswDropButton.Header>
                                    <se:StswIcon Data="{x:Static se:StswIcons.Star}"/>
                                </se:StswDropButton.Header>
                                <se:StswRatingControl ItemsNumber="5"/>
                            </se:StswDropButton>

                            <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding RemoveFileCommand}" Focusable="False" Visibility="Collapsed">
                                <se:StswIcon Data="{x:Static se:StswIcons.TrashCan}"/>
                            </se:StswButton>

                            <se:StswDropButton se:StswControl.IsBorderless="True" Focusable="False" se:StswDropArrow.Visibility="Collapsed">
                                <se:StswDropButton.Header>
                                    <se:StswIcon Data="{x:Static se:StswIcons.Pencil}"/>
                                </se:StswDropButton.Header>

                                <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding RotateLeftCommand}" Focusable="False">
                                    <se:StswIcon Data="{x:Static se:StswIcons.RotateLeft}"/>
                                </se:StswButton>
                                <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding RotateRightCommand}" Focusable="False">
                                    <se:StswIcon Data="{x:Static se:StswIcons.RotateRight}"/>
                                </se:StswButton>

                                <se:StswDropButton.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </se:StswDropButton.ItemsPanel>
                            </se:StswDropButton>

                            <StackPanel DockPanel.Dock="Right" HorizontalAlignment="Right" Orientation="Horizontal">
                                <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding PreviousFileCommand}" Focusable="False">
                                    <se:StswIcon Data="{x:Static se:StswIcons.ArrowLeft}"/>
                                </se:StswButton>
                                <se:StswButton se:StswControl.IsBorderless="True" Command="{Binding NextFileCommand}" Focusable="False">
                                    <se:StswIcon Data="{x:Static se:StswIcons.ArrowRight}"/>
                                </se:StswButton>
                            </StackPanel>

                            <ItemsControl HorizontalAlignment="Center" ItemsSource="{Binding ConfigContext.Shortcuts}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <se:StswButton se:StswControl.IsBorderless="True"
                                                       Command="{Binding Proxy.KeyNumberCommand, Source={StaticResource proxy}}"
                                                       CommandParameter="{Binding Number}"
                                                       Focusable="False"
                                                       Margin="0">
                                            <se:StswIcon Data="{Binding ButtonIcon}"/>
                                        </se:StswButton>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </DockPanel>
                    </DockPanel>
                </se:StswBorder>
            </se:StswSidePanel>
        </Grid>
    </se:StswContentDialog>
</se:StswWindow>
